envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-group[-(1:3),]
groupata<-groupata[-(1:3),]
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
envata.abund <- vegdist(envata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(dist.abund)
mantel(envata.abund,dist.abund,method = "spearman", permutations = 9999, na.rm = TRUE)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/phyla_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Phyla
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
envata.abund <- vegdist(envata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(dist.abund)
each_column_dist<-envata%>%
summarise_all(~dist(.,method = "euclidean"))%>%
as.data.frame()
mantel.pairwise<-function(){
df<- data.frame()
n<-length(colnames(envata))
for(i in 1:n){
x<-mantel(each_column_dist[,i],dist.abund, method = "spearman", permutations = 9999, na.rm = TRUE)
df[1,i]<-x$statistic
df[2,i]<-x$signif
}
colnames(df)<-colnames(each_column_dist)
rownames(df)<-c("Mantel statistic r","Significance")
assign("mantel_output",df,envir = globalenv())
}
mantel.pairwise()
mantel(envata.abund,dist.abund,method = "spearman", permutations = 9999, na.rm = TRUE)
mantel(envata.abund,dist.abund,method = "spearman", permutations = 9999, na.rm = TRUE)
mantel(envata.abund,dist.abund,method = "pearson", permutations = 9999, na.rm = TRUE)
mantel(envata.abund,dist.abund,method = "pearson", permutations = 9999, na.rm = TRUE)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/phyla_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Phyla
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
envata.abund <- vegdist(envata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
each_column_dist<-envata%>%
summarise_all(~dist(.,method = "euclidean"))%>%
as.data.frame()
mantel.pairwise<-function(){
df<- data.frame()
n<-length(colnames(envata))
for(i in 1:n){
x<-mantel(each_column_dist[,i],dist.abund, method = "spearman", permutations = 9999, na.rm = TRUE)
df[1,i]<-x$statistic
df[2,i]<-x$signif
}
colnames(df)<-colnames(each_column_dist)
rownames(df)<-c("Mantel statistic r","Significance")
assign("mantel_output",df,envir = globalenv())
}
mantel.pairwise()
write.xlsx(mantel_output,"C://Users/USER/Desktop/lab/台水計畫/DATA/NGS/豐水期amplicon sequencing data analysis/Mantel's test/包含原水個別參數mantel.xlsx",colNames=T,rowNames=T)
#對整個環境參數的矩陣跟整個物種矩陣做相關性分析
scale.allenv <- scale(envata, center = TRUE, scale = TRUE)
dist.allenv <-dist(scale.allenv, method = "euclidean")
dist.allenv.matirx<-as.matrix(dist.allenv)
mantel(envata.abund,dist.abund,method = "pearson", permutations = 9999, na.rm = TRUE)
mantel(envata.abund,dist.abund,method = "spearman", permutations = 9999, na.rm = TRUE)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/phyla_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Phyla
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
envata.abund <- vegdist(envata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
each_column_dist<-envata%>%
summarise_all(~dist(.,method = "euclidean"))%>%
as.data.frame()
mantel.pairwise<-function(){
df<- data.frame()
n<-length(colnames(envata))
for(i in 1:n){
x<-mantel(each_column_dist[,i],dist.abund, method = "spearman", permutations = 9999, na.rm = TRUE)
df[1,i]<-x$statistic
df[2,i]<-x$signif
}
colnames(df)<-colnames(each_column_dist)
rownames(df)<-c("Mantel statistic r","Significance")
assign("mantel_output",df,envir = globalenv())
}
mantel.pairwise()
write.xlsx(mantel_output,"C://Users/USER/Desktop/lab/台水計畫/DATA/NGS/豐水期amplicon sequencing data analysis/Mantel's test/包含原水個別參數mantel.xlsx",colNames=T,rowNames=T)
mantel(envata.abund,dist.abund,method = "spearman", permutations = 9999, na.rm = TRUE)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
envata.abund <- vegdist(envata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
each_column_dist<-envata%>%
summarise_all(~dist(.,method = "euclidean"))%>%
as.data.frame()
mantel.pairwise<-function(){
df<- data.frame()
n<-length(colnames(envata))
for(i in 1:n){
x<-mantel(each_column_dist[,i],dist.abund, method = "spearman", permutations = 9999, na.rm = TRUE)
df[1,i]<-x$statistic
df[2,i]<-x$signif
}
colnames(df)<-colnames(each_column_dist)
rownames(df)<-c("Mantel statistic r","Significance")
assign("mantel_output",df,envir = globalenv())
}
mantel(envata.abund,dist.abund,method = "spearman", permutations = 9999, na.rm = TRUE)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
View(dbpata)
envata<-as.data.frame(t(envata))
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
View(envata)
envata$sum<-NULL
envata<-envata[1:30,]
envata<-as.data.frame(t(envata))
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
envata.abund <- vegdist(envata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
each_column_dist<-envata%>%
summarise_all(~dist(.,method = "bray"))%>%
as.data.frame()
each_column_dist<-envata%>%
summarise_all(~dist(.,method = "bray"))%>%
as.data.frame()
?dist()
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))%>%
as.data.frame()
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata$sum<-NULL
envata<-envata[1:30,]
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))%>%
as.data.frame()
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata$sum<-NULL
envata<-envata[1:30,]
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
View(envata.abund)
View(dist.abund)
View(envata.abund)
envata.abund <- vegdist(envata, method = "bray")
View(envata)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata$sum<-NULL
envata<-envata[1:30,]
View(envata)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata$sum<-NULL
envata<-envata[1:30,]
envata<-as.data.frame(t(envata))
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))%>%
as.data.frame()
View(envata)
View(envata)
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))%>%
as.data.frame()
View(each_column_dist)
mantel.pairwise<-function(){
df<- data.frame()
n<-length(colnames(envata))
for(i in 1:n){
x<-mantel(each_column_dist[,i],dist.abund, method = "spearman", permutations = 9999, na.rm = TRUE)
df[1,i]<-x$statistic
df[2,i]<-x$signif
}
colnames(df)<-colnames(each_column_dist)
rownames(df)<-c("Mantel statistic r","Significance")
assign("mantel_output",df,envir = globalenv())
}
mantel.pairwise()
library(openxlsx)
library(ggfortify)
library(hrbrthemes)
library(tidyverse)
library(ggbeeswarm)
library(lvplot)
library(hexbin)
library(vegan)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata$sum<-NULL
envata<-envata[1:30,]
envata<-as.data.frame(t(envata))
View(groupata)
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata$sum<-NULL
envata<-envata[1:30,]
envata<-as.data.frame(t(envata))
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
dist.abund<-as.matrix(dist.abund)
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))%>%
as.data.frame()
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata$sum<-NULL
envata<-envata[1:30,]
envata<-as.data.frame(t(envata))
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
envata.abund <- vegdist(envata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))%>%
as.data.frame()
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
groupata<-groupata[-(1:3),]
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
envata.abund <- vegdist(envata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
mantel(envata.abund,dist.abund,method = "spearman", permutations = 9999, na.rm = TRUE)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
dbpata<-as.data.frame(t(dbpata))
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
dbpata<-as.data.frame(t(dbpata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[-(1:3),]
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
dbpata<-as.data.frame(t(dbpata))
envata <- decostand(envata, method = 'hellinger')
dbpata<-dbpata[-(1:3),]
envata<-envata[,-(1:3)]
groupata<-groupata[-(1:3),]
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata$sum<-NULL
envata<-envata[1:30,]
envata<-as.data.frame(t(envata))
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
envata.abund <- vegdist(envata, method = "bray")
dist.abund<-as.matrix(dist.abund)
envata.abund <-as.matrix(envata.abund)
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))%>%
as.data.frame()
View(envata)
mantel(envata.abund,dist.abund,method = "spearman", permutations = 9999, na.rm = TRUE)
mantel(envata.abund,dist.abund,method = "pearson", permutations = 9999, na.rm = TRUE)
spearman
?summarise_all
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))
View(each_column_dist)
envata1<-envata
envata1$g__Polycladomycesvegdist(envata$g__Polycladomyces, method = "bray")
envata1$g__Polycladomyces<-vegdist(envata$g__Polycladomyces, method = "bray")
envata1<-vegdist(envata$g__Polycladomyces, method = "bray")
as.matrix(envata1)
View(dist.abund)
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))%>%
as.list()
View(each_column_dist)
for(i in 1:n){
x<-mantel(each_column_dist[i],dist.abund, method = "spearman", permutations = 9999, na.rm = TRUE)
df[1,i]<-x$statistic
df[2,i]<-x$signif
}
View(each_column_dist)
View(dbpata)
View(envata)
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))
View(each_column_dist)
View(dist.abund)
View(envata)
each_column_dist<-envata%>%
summarise_all(~vegdist(.,method = "bray"))%>%
as.data.frame()
#dbpata<-dbpata[-c(2,6,11),]
#envata<-envata[-c(2,6,11),]
dist.abund <- vegdist(dbpata, method = "bray")
mantel.pairwise<-function(){
df<- data.frame()
n<-length(colnames(envata))
for(i in 1:n){
x<-mantel(each_column_dist[,i],dist.abund, method = "spearman", permutations = 9999, na.rm = TRUE)
df[1,i]<-x$statistic
df[2,i]<-x$signif
}
colnames(df)<-colnames(each_column_dist)
rownames(df)<-c("Mantel statistic r","Significance")
assign("mantel_output",df,envir = globalenv())
}
mantel.pairwise()
View(mantel_output)
View(mantel_output)
