color<-c( "#FFFFB3" ,"#BEBADA"  ,"#80B1D3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity")+
labs(x=NULL,y=NULL)+scale_fill_manual(values = color)+scale_color_manual(values = color)+theme_bw()+labs(x="Sample",y="Relative abundance")+theme(axis.title = element_text(size=12.5),legend.title= element_text(size=12.5),legend.text = element_text(size=12.5))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity")+
labs(x=NULL,y=NULL)+scale_fill_manual("location",values = color)+scale_color_manual(values = color)+theme_bw()+labs(x="Sample",y="Relative abundance")+theme(axis.title = element_text(size=12.5),legend.title= element_text(size=12.5),legend.text = element_text(size=12.5))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity")+
labs(x=NULL,y=NULL)+scale_fill_manual("location",values = color)+scale_color_manual("location",values = color)+theme_bw()+labs(x="Sample",y="Relative abundance")+theme(axis.title = element_text(size=12.5),legend.title= element_text(size=12.5),legend.text = element_text(size=12.5))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity")+
labs(x=NULL,y=NULL)+scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="Sample",y="Relative abundance")+theme(axis.title = element_text(size=12.5),legend.title= element_text(size=12.5),legend.text = element_text(size=12.5))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity")+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="Sample",y="Relative abundance")+
theme(axis.title = element_text(size=12.5),legend.title= element_text(size=12.5),legend.text = element_text(size=12.5))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity")+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=12.5),legend.title= element_text(size=12.5),legend.text = element_text(size=12.5))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity",width=0.6)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=12.5),legend.title= element_text(size=12.5),legend.text = element_text(size=12.5))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=12.5),legend.title= element_text(size=12.5),legend.text = element_text(size=12.5))
data_stat_percentage$plas_type<-str_to_sentence(data_stat_percentage$plas_type)
color<-c( "#FFFFB3" ,"#BEBADA"  ,"#80B1D3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=12.5),legend.title= element_text(size=12.5),legend.text = element_text(size=12.5))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.85,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=13),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=13),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12.5),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
##draw ARG type plasflow output
data_stat_percentage<-data_stat%>%
group_by(type.x)%>%
mutate(percent=n/sum(n))%>%
mutate(sum=sum(n))
data_stat_percentage$type.x<-str_to_sentence(data_stat_percentage$type.x)
data_stat_percentage$type.x[data_stat_percentage$type.x=="Macrolide-lincosamide-streptogramin"]<-"MLS"
data_stat_percentage$plas_type<-str_to_sentence(data_stat_percentage$plas_type)
color<-c( "#FFFFB3" ,"#BEBADA"  ,"#80B1D3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
data_stat
#sum
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=n,fill=plas_type,color=plas_type),position="dodge",stat="identity",alpha=0.7)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
#sum
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=n,fill=plas_type,color=plas_type),stat="identity",alpha=0.7)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
#sum
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=n,fill=plas_type,color=plas_type),stat="identity",alpha=0.7)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARCs number")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
#sum
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=n,fill=plas_type,color=plas_type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARCs number")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
#sum
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=n,fill=plas_type,color=plas_type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC number")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
color<-c( "#BEBADA"  ,"#80B1D3","#FFFFB3" , ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
#relative abundance
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
color<-c( "#BEBADA"  ,"#80B1D3","#FFFFB3" ,,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
#relative abundance
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
color<-c( "#BEBADA"  ,"#80B1D3","#FFFFB3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
#relative abundance
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
color<-c( "#80B1D3","#BEBADA"  ,"#FFFFB3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
#relative abundance
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
#sum
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=n,fill=plas_type,color=plas_type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC number")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
#sum
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=n,fill=plas_type,color=plas_type),stat="identity",position="dodge",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC number")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
#sum
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=n,fill=plas_type,color=plas_type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC number")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
##draw location plasflow output
data_contig_Sample<-read.xlsx("C:/Users/USER/Desktop/ARC_plasflow out.xlsx",sheet=2)
View(data_contig_Sample)
View(data_contig_Sample)
data_contig_Sample<-data_contig_Sample%>%
separate(label,into=c("type","NUL"),sep=".")
View(data_stat_percentage)
View(data_contig_Sample)
data_contig_Sample<-data_contig_Sample%>%
separate(label,into=c("type","NUL"),sep="\.")
##draw location plasflow output
data_contig_Sample<-read.xlsx("C:/Users/USER/Desktop/ARC_plasflow out.xlsx",sheet=2)
View(data_contig_Sample)
data_contig_Sample<-data_contig_Sample%>%
separate(label,into=c("type","NUL"),sep=".")
View(data_contig_Sample)
##draw location plasflow output
data_contig_Sample<-read.xlsx("C:/Users/USER/Desktop/ARC_plasflow out.xlsx",sheet=2)
View(data_contig_Sample)
data_contig_Sample<-data_contig_Sample%>%
separate(label,into=c("type","NUL",'ff'),sep=".")
data_contig_Sample<-data_contig_Sample%>%
separate(label,into=c("type","NUL"))
View(data_contig_Sample)
##draw location plasflow output
data_contig_Sample<-read.xlsx("C:/Users/USER/Desktop/ARC_plasflow out.xlsx",sheet=2)
View(data_contig_Sample)
data_contig_Sample<-data_contig_Sample%>%
separate(label,into=c("type","NUL"))
View(data_contig_Sample)
data_contig_Sample$id<-NULL
data_contig_Sample$NUL<-NULL
data_contig_Sample$Sample[data_contig_Sample$Sample=="T1"]<-"Raw"
View(data_contig_Sample)
data_contig_Sample$Sample[data_contig_Sample$Sample=="T1"]<-"Raw"
data_contig_Sample$Sample[data_contig_Sample$Sample=="T1"]<-"Raw"
data_contig_Sample<-read.xlsx("C:/Users/USER/Desktop/ARC_plasflow out.xlsx",sheet=2)
data_contig_Sample<-data_contig_Sample%>%
separate(label,into=c("type","NUL"))
data_contig_Sample$id<-NULL
data_contig_Sample$NUL<-NULL
data_contig_Sample$Sample[data_contig_Sample$Sample=="T1"]<-"Raw"
data_contig_Sample$Sample[data_contig_Sample$Sample=="T2"]<-"Finished"
data_contig_Sample$Sample[data_contig_Sample$Sample=="T3"]<-"Upstream"
data_contig_Sample$Sample[data_contig_Sample$Sample=="T4"]<-"Midstream"
data_contig_Sample$Sample[data_contig_Sample$Sample=="T5"]<-"Downstream"
data_contig_Sample$type<-str_to_sentence(data_contig_Sample$type)
View(data_contig_Sample)
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)%>%
mutate(percent=n/sum(n))%>%
mutate(sum=sum(n))
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)
View(data_contig_Sample)
View(data_contig_Sample_sta)
View(data_contig_Sample)
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)
View(data_contig_Sample_sta)
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)%>%
count()
View(data_stat)
View(data_contig_Sample_sta)
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)%>%
count()%>%
group_by(Sample)%>%
mutate(percent=n/sum(n))%>%
mutate(sum=sum(n))
View(data_contig_Sample_sta)
data_contig_Sample_sta$Sample<-factor(data_contig_Sample_sta$Sample,levels = c("Raw","Finished","Upstream","Midstream","Downstream"))
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)%>%
count()%>%
group_by(Sample)%>%
mutate(percent=n/sum(n))%>%
mutate(sum=sum(n))
View(data_contig_Sample)
View(data_contig_Sample_sta)
ggplot(data_contig_Sample_sta)+geom_bar(aes(x=Sample,y=percent,fill=type,color=type),alpha=0.7,stat="identity",width=0.8)
##draw location plasflow output
data_contig_Sample<-read.xlsx("C:/Users/USER/Desktop/ARC_plasflow out.xlsx",sheet=2)
data_contig_Sample<-data_contig_Sample%>%
separate(label,into=c("type","NUL"))
data_contig_Sample$id<-NULL
data_contig_Sample$NUL<-NULL
data_contig_Sample$Sample[data_contig_Sample$Sample=="T1"]<-"Raw"
data_contig_Sample$Sample[data_contig_Sample$Sample=="T2"]<-"Finished"
data_contig_Sample$Sample[data_contig_Sample$Sample=="T3"]<-"Upstream"
data_contig_Sample$Sample[data_contig_Sample$Sample=="T4"]<-"Midstream"
data_contig_Sample$Sample[data_contig_Sample$Sample=="T5"]<-"Downstream"
data_contig_Sample$type<-str_to_sentence(data_contig_Sample$type)
data_contig_Sample_sta$Sample<-factor(data_contig_Sample_sta$Sample,levels = c("Raw","Finished","Upstream","Midstream","Downstream"))
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)%>%
count()%>%
group_by(Sample)%>%
mutate(percent=n/sum(n))%>%
mutate(sum=sum(n))
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)%>%
count()%>%
group_by(Sample)%>%
mutate(percent=n/sum(n))%>%
mutate(sum=sum(n))
data_contig_Sample_sta$Sample<-factor(data_contig_Sample_sta$Sample,levels = c("Raw","Finished","Upstream","Midstream","Downstream"))
ggplot(data_contig_Sample_sta)+geom_bar(aes(x=Sample,y=percent,fill=type,color=type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_contig_Sample_sta)+geom_bar(aes(x=Sample,y=percent,fill=type,color=type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="Location",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_contig_Sample_sta)+geom_bar(aes(x=Sample,y=percent,fill=type,color=type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Gene location",values = color)+theme_bw()+labs(x="Gene location",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_contig_Sample_sta)+geom_bar(aes(x=Sample,y=percent,fill=type,color=type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Gene location",values = color)+scale_color_manual("Gene location",values = color)+theme_bw()+labs(x="Location",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_contig_Sample_sta)+geom_bar(aes(x=Sample,y=percent,fill=type,color=type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Gene Location",values = color)+scale_color_manual("Gene Location",values = color)+theme_bw()+labs(x="Location",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_contig_Sample_sta)+geom_bar(aes(x=Sample,y=percent,fill=type,color=type),alpha=0.7,stat="identity")+
scale_fill_manual("Gene Location",values = color)+scale_color_manual("Gene Location",values = color)+theme_bw()+labs(x="Location",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
data_contig_Sample
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)%>%
filter(contig_length>=1000)%>%
count()%>%
group_by(Sample)%>%
mutate(percent=n/sum(n))%>%
mutate(sum=sum(n))
data_contig_Sample_sta$Sample<-factor(data_contig_Sample_sta$Sample,levels = c("Raw","Finished","Upstream","Midstream","Downstream"))
ggplot(data_contig_Sample_sta)+geom_bar(aes(x=Sample,y=percent,fill=type,color=type),alpha=0.7,stat="identity")+
scale_fill_manual("Gene Location",values = color)+scale_color_manual("Gene Location",values = color)+theme_bw()+labs(x="Location",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
View(data_contig_Sample)
View(data_contig_Sample_sta)
data_contig_Sample_sta<-data_contig_Sample%>%
group_by(Sample,type)%>%
count()%>%
group_by(Sample)%>%
mutate(percent=n/sum(n))%>%
mutate(sum=sum(n))
data_contig_Sample_sta$Sample<-factor(data_contig_Sample_sta$Sample,levels = c("Raw","Finished","Upstream","Midstream","Downstream"))
ggplot(data_contig_Sample_sta)+geom_bar(aes(x=Sample,y=percent,fill=type,color=type),alpha=0.7,stat="identity")+
scale_fill_manual("Gene Location",values = color)+scale_color_manual("Gene Location",values = color)+theme_bw()+labs(x="Location",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
data_contig_Sample
data_stat
View(data_contig_Sample)
View(data_contig_Sample_sta)
View(data_contig)
#coverage
data_stat_percentage<-data_contig%>%
group_by(type.x,plas_type)%>%
summarise_at(vars(contig_coverage), funs(sum))
View(data_stat_percentage)
#coverage
data_stat_cover_sum<-data_contig%>%
group_by(type.x,plas_type)%>%
summarise_at(vars(contig_coverage), funs(sum))
View(data_stat_cover_sum)
ggplot(data_stat_percentage)+geom_bar(aes(x=type.x,y=contig_coverage,fill=plas_type,color=plas_type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC number")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_stat_cover_sum)+geom_bar(aes(x=type.x,y=contig_coverage,fill=plas_type,color=plas_type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC number")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_stat_cover_sum)+geom_bar(aes(x=type.x,y=contig_coverage,fill=plas_type,color=plas_type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
#coverage
data_stat_cover_sum<-data_contig%>%
group_by(type.x,plas_type)%>%
summarise_at(vars(contig_coverage), funs(sum))
data_stat_cover_sum$type.x<-str_to_sentence(data_stat_cover_sum$type.x)
data_stat_cover_sum$type.x[data_stat_cover_sum$type.x=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat_cover_sum)+geom_bar(aes(x=type.x,y=contig_coverage,fill=plas_type,color=plas_type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
View(data_stat_cover_sum)
data_stat_cover_sum<-data_contig%>%
group_by(type.x,plas_type)%>%
summarise_at(vars(contig_coverage), funs(sum))%>%
group_by(type.x)%>%
mutate(percent=contig_coverage/sum(contig_coverage))%>%
mutate(sum=sum(contig_coverage))
View(data_stat_percentage)
View(data_stat_cover_sum)
ggplot(data_stat_cover_sum)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_stat_cover_sum)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Covereage Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
##coverage relative abundance
data_stat_cover_sum<-data_contig%>%
group_by(type.x,plas_type)%>%
summarise_at(vars(contig_coverage), funs(sum))%>%
group_by(type.x)%>%
mutate(percent=contig_coverage/sum(contig_coverage))%>%
mutate(sum=sum(contig_coverage))
data_stat_cover_sum$type.x<-str_to_sentence(data_stat_cover_sum$type.x)
data_stat_cover_sum$type.x[data_stat_cover_sum$type.x=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat_cover_sum)+geom_bar(aes(x=type.x,y=percent,fill=plas_type,color=plas_type),alpha=0.7,stat="identity",width=0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="Covereage Relative abundance")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_contig<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARC_analysis/ARC_phyla_整理.xlsx",sheet=1)
data_contig$contig_phyla[is.na(data_contig$contig_phyla)]<-"Unclassified"
data_contig$contig_phyla[data_contig$contig_phyla == "Bacteria"]<-"Unclassified"
data_stat<-data_contig%>%
group_by(Sample)%>%
count(type)%>%
mutate(type_ACC_percent=n/sum(n))
data_phyl_stat<-data_contig%>%
count(contig_phyla)%>%
mutate(phyla_ACC_percent=n/248)
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_contig<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARC_analysis/ARC_phyla_整理.xlsx",sheet=1)
data_contig$contig_phyla[is.na(data_contig$contig_phyla)]<-"Unclassified"
data_contig$contig_phyla[data_contig$contig_phyla == "Bacteria"]<-"Unclassified"
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_contig<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARC_analysis/ARC_phyla_整理.xlsx",sheet=1)
data_contig$contig_phyla[is.na(data_contig$contig_phyla)]<-"Unclassified"
data_contig$contig_phyla[data_contig$contig_phyla == "Bacteria"]<-"Unclassified"
data_stat<-data_contig%>%
group_by(type,subtype)%>%
summarise_at(vars(orf_coverage), funs(sum))
data_stat<-data_contig%>%
group_by(type,subtype)%>%
summarise_at(vars(orf_coverage), funs(sum))
View(data_stat)
data_stat<-data_contig%>%
group_by(Sample,type,subtype)%>%
summarise_at(vars(orf_coverage), funs(sum))
View(data_stat)
data_stat_cover_sum$type<-str_to_sentence(data_stat_cover_sum$type)
data_stat<-data_contig%>%
group_by(Sample,type)%>%
summarise_at(vars(orf_coverage), funs(sum))
data_stat<-data_contig%>%
group_by(Sample,type)%>%
summarise_at(vars(orf_coverage), funs(sum))
v$type<-str_to_sentence(data_stat$type)
data_stat$type.x[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type.x[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
data_stat<-data_contig%>%
group_by(Sample,type)%>%
summarise_at(vars(orf_coverage), funs(sum))
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
View(data_stat)
color<-c( "#FFFFB3" ,"#BC80BD" , "#FB8072" ,"#80B1D3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
ggplot(data_stat)+geom_bar(aes(x=Sample,y=,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)
color<-hcl.colors(14,'Set3')
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
color<-hcl.colors(14,'Set3')
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
color
color1<-c( "#FFFFB3" ,"#BC80BD" , "#FB8072" ,"#80B1D3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")\
color<-hcl.colors(14,'Set3')
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
cols <- hcl.colors(31, "Set3")
library(RColorBrewer)
cols<- hcl.colors(31, "Set3")
library(ggsankey)
cols<- hcl.colors(12, "Set3")
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
color1<-c( "#FFFFB3" ,"#BC80BD" , "#FB8072" ,"#80B1D3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")\
color<- hcl.colors(12, "Set3")
color<- hcl.colors(14, "Set3")
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
color<- hcl.colors(14, "Set3")
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
library(ggsankey)
##ARG orf type coverage
data_stat<-data_contig%>%
group_by(Sample,type)%>%
summarise_at(vars(orf_coverage), funs(sum))
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
##ARG orf type coverage
data_stat<-data_contig%>%
group_by(Sample,type)%>%
summarise_at(vars(orf_coverage), funs(sum))
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
library(ggsankey)
data_contig<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARC_analysis/ARC_phyla_整理.xlsx",sheet=1)
data_contig$contig_phyla[is.na(data_contig$contig_phyla)]<-"Unclassified"
data_contig$contig_phyla[data_contig$contig_phyla == "Bacteria"]<-"Unclassified"
##ARG orf type coverage
data_stat<-data_contig%>%
group_by(Sample,type)%>%
summarise_at(vars(orf_coverage), funs(sum))
color1<-c( "#FFFFB3" ,"#BC80BD" , "#FB8072" ,"#80B1D3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
color<- hcl.colors(14, "Set3")
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
color<- hcl.colors(14, "Sunset")
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
data_stat<-data_contig%>%
group_by(Sample,type,subtype)%>%
summarise_at(vars(orf_coverage), funs(sum))
data_stat<-data_contig%>%
group_by(Sample,type)%>%
summarise_at(vars(orf_coverage), funs(sum))
data_stat$Sample[data_stat$Sample=="T1"]<-"Raw"
data_stat$Sample[data_stat$Sample=="T2"]<-"Finished"
data_stat$Sample[data_stat$Sample=="T3"]<-"Upstream"
data_stat$Sample[data_stat$Sample=="T4"]<-"Midstream"
data_stat$Sample[data_stat$Sample=="T5"]<-"Downstream"
data_stat$type<-str_to_sentence(data_stat$type)
data_stat$type[data_stat$type=="Macrolide-lincosamide-streptogramin"]<-"MLS"
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
data_stat$Sample<-factor(data_stat$Sample,levels = c("Raw","Finished","Upstream","Midstream","Downstream"))
color1<-c( "#FFFFB3" ,"#BC80BD" , "#FB8072" ,"#80B1D3" ,"#FDB462" ,"#B3DE69" ,"#FCCDE5" ,"#D9D9D9","#BEBADA" ,"#CCEBC5" ,"#FFED6F")
color<- hcl.colors(14, "Sunset")
ggplot(data_stat)+geom_bar(aes(x=Sample,y=orf_coverage,fill=type,color=type),stat="identity",alpha=0.7,width = 0.8)+
scale_fill_manual("Location",values = color)+scale_color_manual("Location",values = color)+theme_bw()+labs(x="ARG Type",y="ARC coverage (x/GB)")+
theme(axis.title = element_text(size=13),axis.text = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
##ARG orf subtype coverage
data_stat<-data_contig%>%
group_by(Sample,type,subtype)%>%
summarise_at(vars(orf_coverage), funs(sum))
data_stat<-data_contig%>%
group_by(Sample,type,subtype)%>%
summarise_at(vars(orf_coverage), funs(sum))
View(data_stat)
View(data_stat)
View(data_contig)
View(data_stat)
View(data_contig)
View(data_stat)
data_stat<-data_contig%>%
group_by(Sample,type,subtype,contig_phyla,contig_taxon.x)
data_stat<-data_contig%>%
group_by(Sample,type,subtype,contig_phyla,contig_taxon.x)%>%
summarise_at(vars(orf_coverage), funs(sum))
View(data_stat)
