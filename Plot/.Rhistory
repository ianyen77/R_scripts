View(data_log)
library(pheatmap)
library(openxlsx)
library(tidyverse)
library(pheatmap)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/SARGv3.2/ARG_oap_V3.2out.xlsx",sheet=1,rowNames = F)
data<-separate(data,subtype,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
library(pheatmap)
library(openxlsx)
library(tidyverse)
library(pheatmap)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/SARGv3.2/ARG_oap_V3.2out.xlsx",sheet=1,rowNames = F)
data<-separate(data,subtype,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data<-data%>%
arrange(desc(sum))
data<-data%>%
arrange(desc(sum))
View(data)
library(pheatmap)
library(openxlsx)
library(tidyverse)
library(pheatmap)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/SARGv3.2/ARG_oap_V3.2out.xlsx",sheet=1,rowNames = F)
data<-separate(data,subtype,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
library(pheatmap)
library(openxlsx)
library(tidyverse)
library(pheatmap)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/SARGv3.2/ARG_oap_V3.2out.xlsx",sheet=1,rowNames = F)
data<-separate(data,subtype,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
View(data_argname)
View(data_argname)
data$subtype[35]<-"aminoglycoside_amrB"
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data$sum<-NULL
data<-data[1:50,]
data<-data%>%
arrange(data$type)
data[data == 0] <- NA
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
location<-c("Raw","Raw","Raw","Finished","Finished","Finished","Upstream","Upstream","Upstream","Midstream","Midstream","Midstream","Downstream","Downstream","Downstream")
row_ano<-data.frame(cbind(colnames(data),location))
rownames(row_ano)<-row_ano$V1
row_ano$V1<-NULL
#畫圖
data<-data[,-(1:2)]
data_log<-log10(data)
pheatmap(data_log,cluster_rows = F,cluster_cols = F)
pheatmap(data_log,cluster_rows = F,cluster_cols = F,color=colorRampPalette(c("#FCFBFD", "#BCBDDC", "#54278F"))(50))
library(openxlsx)
library(tidyverse)
#這是一個提
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/SARGv3.2/ARG_oap_V3.2out.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
#dbpata<-as.data.frame(t(dbpata))
output<- vector(mode = "list")
#第一個回圈可以計算各別sample
for (i in 2:length(colnames(dbpata))){
list1<-dbpata%>%
filter(dbpata[,i]!=0)
list1<-list1[,1]%>%
as.data.frame()
output<-c(output,list1)
}
x<-colnames(dbpata)[2:16]
names(output)<-x
output2<- vector(mode = "list")
#此回圈用於計算各組sample所有>0.005的總和(本質上在計算三重複各個sample出現所有人有誰，剔除重複)
for(i in seq(1,15,by =3)){
list1<-as.data.frame(unique(c(output[[i]],output[[i+1]],output[[i+2]])))
output2<-c(output2,list1)
}
names(output2)<-c("Raw","Finished","Upstream","Midstream","Downstream")
write.xlsx(output2,file="c:/Users/USER/Desktop/ARG_occurance.xlsx")
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv")
View(dbpata1)
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
View(groupata)
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
View(dbpata1)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = T)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = TRUE)
read.csv
read.csv
?read.csv
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names=TRUE)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = T)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = NULL)
View(dbpata1)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = 1)
View(dbpata1)
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
dbpata<-dbpata1
dbpata[is.na(dbpata)]<-0
dbpata <- decostand(dbpata, method = 'hellinger')
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=Location),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
View(points)
View(dbpata)
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = 1)
View(dbpata1)
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
dbpata<-dbpata1
dbpata[is.na(dbpata)]<-0
rownames(dbpata)<-dbpata$Species
dbpata$Species<-NULL
dbpata <- decostand(dbpata, method = 'hellinger')
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
View(groupata)
View(dbpata)
View(dbpata)
View(dbpata1)
View(groupata)
View(dbpata)
View(dbpata1)
View(groupata)
View(dbpata1)
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = 1)
?read.csv
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
View(dbpata)
View(dbpata)
dbpata <- decostand(dbpata, method = 'hellinger')
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=Location),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = 1)
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
dbpata <- decostand(dbpata1, method = 'hellinger')
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=Location),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
View(points)
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=rownames(points)),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/families.csv",row.names = 1)
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/families.csv",row.names = 1)
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
dbpata <- decostand(dbpata1, method = 'hellinger')
View(dbpata1)
View(dbpata)
View(dbpata1)
View(dbpata)
View(groupata)
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = 1)
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
dbpata <-as.data.frame(t(dbpata))
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/genus.csv",row.names = 1)
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=rownames(points)),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
dbpata<-read.csv("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/台水二次定序/rel_abundance_table/families.csv",row.names = 1)
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=rownames(points)),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=3,rowNames=F,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=3,rowNames=F,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
View(dbpata1)
groupata$location<-NULL
dbpata<-dbpata1
is.na(dbpata)
rownames(dbpata)<-dbpata$Species
dbpata$Species<-NULL
dbpata <- decostand(dbpata, method = 'hellinger')
View(dbpata)
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=Location),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=3,rowNames=F,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
dbpata<-dbpata1
dbpata[is.na(dbpata)]<-0
rownames(dbpata)<-dbpata$Species
dbpata$Species<-NULL
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=Location),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=3,rowNames=F,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
dbpata <- decostand(dbpata, method = 'hellinger')
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=3,rowNames=F,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
rownames(dbpata)<-dbpata$Species
dbpata$Species<-NULL
dbpata <- decostand(dbpata, method = 'hellinger')
library(vegan)
library(ecodist)
library(openxlsx)
library(ggfortify)
library(RColorBrewer)
dbpata1<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=3,rowNames=F,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/台水計畫/DATA/台水二次定序/2023.02.24 species table.xlsx",sheet=5,rowNames=T,colNames=T,sep.names=" ")
groupata$Location<-c("Biofilm","Raw","Finished","Upsteram","Midstream","Downstream")
groupata$location<-NULL
dbpata<-dbpata1
rownames(dbpata)<-dbpata$Species
dbpata$Species<-NULL
dbpata <- decostand(dbpata, method = 'hellinger')
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
family_bray
family_bray<-read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3)
family_bray<-as.dist(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3))
family_bray<-as.dist(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T))
fammily_bray
family_bray
read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T)
as.dist(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T))
family_bray<-as.dist(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T,na.strings = F))
read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T,na.strings = F)
as.dist(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T,na.strings = F))
family_bray<-as.matrix(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=1))
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
family_bray<-as.matrix(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=1,rowNames = T))
family_bray
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
family_bray
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=Location),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
family_bray<-as.matrix(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T))
family_bray
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
family_bray<-as.matrix(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T,na.strings = F))
View(family_bray)
family_bray<-as.matrix(na.omit(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T,na.strings = F)))
family_bray<-as.matrix(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=3,rowNames = T,na.strings = F))
family_bray<-as.matrix(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=1,rowNames = T,na.strings = F))
family_bray
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
family_bray
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=Location),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=Location),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Weighted Unifrac PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
family_bray<-as.matrix(read.xlsx("C:/Users/USER/Desktop/unifrec 二次定序.xlsx",sheet=2,rowNames = T,na.strings = F))
family_bray
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
hcl.colors(2,"sunset")
family_bray
ggplot(points, aes(x=Dim1, y=Dim2))+
theme_bw()+
geom_point(size=3,alpha=0.6,color="#704D9E",fill="#704D9E")+geom_vline(xintercept = 0, color = 'gray', linetype = 2) +geom_text(aes(label=Location),size=3.6,color="black",hjust = 0.4, vjust = 2)+
geom_hline(yintercept = 0, color = 'gray', linetype = 2,) +
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Unweighted Unifrac PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
