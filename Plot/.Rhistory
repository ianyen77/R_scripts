envata<-as.data.frame(t(envata))
MGE<-as.data.frame(t(MGE))
#檢查環境變量的相關性，共線的環境變量要去除
panel.cor <- function(x, y, digits=2, prefix="", cex.cor) {
usr <- par("usr")
on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y, use = "complete.obs"))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste(prefix, txt, sep = "")
if (missing(cex.cor)) cex <- 0.8 / strwidth(txt)
test <- cor.test(x, y)
# borrowed from printCoefmat
Signif <- symnum(
test$p.value, corr = FALSE, na = FALSE,
cutpoints = c(0, 0.05, 0.1, 1),
symbols = c("*", ".", " ")
)
text(0.5, 0.5, txt, cex = cex * r)
text(.8, .8, Signif, cex = cex, col = 2)
}
pairs(MGE,lower.panel = panel.smooth,upper.panel = panel.cor)
library(vegan)
library(ecodist)
library(ggplot2)
library(openxlsx)
library(ggfortify)
library(tidyverse)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
MGE<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=2,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
#Genus 篩選
envata<-envata%>%
filter(apply(envata,1,function(x) sum(x>0)>=15))
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata<-envata[1:10,]
envata$sum<-NULL
#MGE篩選
MGE<-MGE%>%
filter(apply(MGE,1,function(x) sum(x>0)>=7))
MGE$sum<-apply(MGE,1,sum)
MGE<-MGE%>%
arrange(desc(sum))
MGE<-MGE[1:5,]
MGE$sum<-NULL
#data format transform
#envata<-scale(envata)
envata <- decostand(envata, method = 'hellinger')
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
MGE<-as.data.frame(t(MGE))
#檢查環境變量的相關性，共線的環境變量要去除
panel.cor <- function(x, y, digits=2, prefix="", cex.cor) {
usr <- par("usr")
on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y, use = "complete.obs"))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste(prefix, txt, sep = "")
if (missing(cex.cor)) cex <- 0.8 / strwidth(txt)
test <- cor.test(x, y)
# borrowed from printCoefmat
Signif <- symnum(
test$p.value, corr = FALSE, na = FALSE,
cutpoints = c(0, 0.05, 0.1, 1),
symbols = c("*", ".", " ")
)
text(0.5, 0.5, txt, cex = cex * r)
text(.8, .8, Signif, cex = cex, col = 2)
}
pairs(MGE,lower.panel = panel.smooth,upper.panel = panel.cor)
library(vegan)
library(ecodist)
library(ggplot2)
library(openxlsx)
library(ggfortify)
library(tidyverse)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
MGE<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=2,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
#MGE篩選
MGE<-MGE%>%
filter(apply(MGE,1,function(x) sum(x>0)>=7))
MGE$sum<-apply(MGE,1,sum)
MGE<-MGE%>%
arrange(desc(sum))
MGE<-MGE[1:5,]
MGE$sum<-NULL
#MGE篩選
MGE<-MGE%>%
filter(apply(MGE,1,function(x) sum(x>0)>=7))
library(vegan)
library(ecodist)
library(ggplot2)
library(openxlsx)
library(ggfortify)
library(tidyverse)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
MGE<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=2,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
#Genus 篩選
envata<-envata%>%
filter(apply(envata,1,function(x) sum(x>0)>=15))
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata<-envata[1:10,]
envata$sum<-NULL
#MGE篩選
MGE<-MGE%>%
filter(apply(MGE,1,function(x) sum(x>0)>=7))
MGE$sum<-apply(MGE,1,sum)
MGE<-MGE%>%
arrange(desc(sum))
MGE<-MGE[1:3,]
MGE$sum<-NULL
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
MGE<-as.data.frame(t(MGE))
#檢查環境變量的相關性，共線的環境變量要去除
panel.cor <- function(x, y, digits=2, prefix="", cex.cor) {
usr <- par("usr")
on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y, use = "complete.obs"))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste(prefix, txt, sep = "")
if (missing(cex.cor)) cex <- 0.8 / strwidth(txt)
test <- cor.test(x, y)
# borrowed from printCoefmat
Signif <- symnum(
test$p.value, corr = FALSE, na = FALSE,
cutpoints = c(0, 0.05, 0.1, 1),
symbols = c("*", ".", " ")
)
text(0.5, 0.5, txt, cex = cex * r)
text(.8, .8, Signif, cex = cex, col = 2)
}
pairs(MGE,lower.panel = panel.smooth,upper.panel = panel.cor)
library(vegan)
library(ecodist)
library(ggplot2)
library(openxlsx)
library(ggfortify)
library(tidyverse)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
MGE<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=2,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
#Genus 篩選
envata<-envata%>%
filter(apply(envata,1,function(x) sum(x>0)>=15))
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata<-envata[1:10,]
envata$sum<-NULL
#MGE篩選
MGE<-MGE%>%
filter(apply(MGE,1,function(x) sum(x>0)>=5))
MGE$sum<-apply(MGE,1,sum)
library(vegan)
library(ecodist)
library(ggplot2)
library(openxlsx)
library(ggfortify)
library(tidyverse)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
MGE<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=2,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
#Genus 篩選
envata<-envata%>%
filter(apply(envata,1,function(x) sum(x>0)>=15))
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata<-envata[1:10,]
envata$sum<-NULL
#MGE篩選
MGE<-MGE%>%
filter(apply(MGE,1,function(x) sum(x>0)>=5))
MGE$sum<-apply(MGE,1,sum)
MGE<-MGE%>%
arrange(desc(sum))
MGE<-MGE[1:5,]
MGE$sum<-NULL
#data format transform
#envata<-scale(envata)
envata <- decostand(envata, method = 'hellinger')
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
MGE<-as.data.frame(t(MGE))
#檢查環境變量的相關性，共線的環境變量要去除
panel.cor <- function(x, y, digits=2, prefix="", cex.cor) {
usr <- par("usr")
on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y, use = "complete.obs"))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste(prefix, txt, sep = "")
if (missing(cex.cor)) cex <- 0.8 / strwidth(txt)
test <- cor.test(x, y)
# borrowed from printCoefmat
Signif <- symnum(
test$p.value, corr = FALSE, na = FALSE,
cutpoints = c(0, 0.05, 0.1, 1),
symbols = c("*", ".", " ")
)
text(0.5, 0.5, txt, cex = cex * r)
text(.8, .8, Signif, cex = cex, col = 2)
}
pairs(MGE,lower.panel = panel.smooth,upper.panel = panel.cor)
View(MGE)
View(MGE)
View(envata)
envata<-cbind(envata,MGE)
View(envata)
pairs(envata,lower.panel = panel.smooth,upper.panel = panel.cor)
envata<-scale(envata)
#檢查環境變量的相關性，共線的環境變量要去除
panel.cor <- function(x, y, digits=2, prefix="", cex.cor) {
usr <- par("usr")
on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y, use = "complete.obs"))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste(prefix, txt, sep = "")
if (missing(cex.cor)) cex <- 0.8 / strwidth(txt)
test <- cor.test(x, y)
# borrowed from printCoefmat
Signif <- symnum(
test$p.value, corr = FALSE, na = FALSE,
cutpoints = c(0, 0.05, 0.1, 1),
symbols = c("*", ".", " ")
)
text(0.5, 0.5, txt, cex = cex * r)
text(.8, .8, Signif, cex = cex, col = 2)
}
pairs(envata,lower.panel = panel.smooth,upper.panel = panel.cor)
rda.vpa <- varpart(dbpata, envata[,c(1:10)],envata[,c(11:15)],chisquare = FALSE)
rda.vpa <- varpart(dbpata, envata[,c(1:8)],envata[,c(11:14)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
rda.vpa <- varpart(dbpata, envata[,c(1:8)],envata[,c(11:13)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
## 繪圖數據提取
s.RDA=arg_cca_1$CCA$u#提取樣本之特徵值
rda.vpa <- varpart(dbpata, envata[,c(1:5)],envata[,c(11:13)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
rda.vpa <- varpart(dbpata, envata[,c(1:3)],envata[,c(11:13)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
pairs(envata,lower.panel = panel.smooth,upper.panel = panel.cor)
#判斷要用RDA還是CCA,if DCA1 length >4 use cca
sel <- decorana(dbpata)
sel
#變量篩選
arg_cca<-rda(dbpata ~., data=envata)
summary(arg_cca)
envata<-as.data.frame(cbind(envata,MGE))
envata<-scale(envata)
#檢查環境變量的相關性，共線的環境變量要去除
panel.cor <- function(x, y, digits=2, prefix="", cex.cor) {
usr <- par("usr")
on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y, use = "complete.obs"))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste(prefix, txt, sep = "")
if (missing(cex.cor)) cex <- 0.8 / strwidth(txt)
test <- cor.test(x, y)
# borrowed from printCoefmat
Signif <- symnum(
test$p.value, corr = FALSE, na = FALSE,
cutpoints = c(0, 0.05, 0.1, 1),
symbols = c("*", ".", " ")
)
text(0.5, 0.5, txt, cex = cex * r)
text(.8, .8, Signif, cex = cex, col = 2)
}
pairs(envata,lower.panel = panel.smooth,upper.panel = panel.cor)
#判斷要用RDA還是CCA,if DCA1 length >4 use cca
sel <- decorana(dbpata)
sel
#變量篩選
arg_cca<-rda(dbpata ~., data=envata)
library(vegan)
library(ecodist)
library(ggplot2)
library(openxlsx)
library(ggfortify)
library(tidyverse)
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
envata<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=1,rowNames=F,colNames=T,sep.names=" ")
MGE<-read.xlsx("C:/Users/USER/Desktop/Genus_TAXA_vpa.xlsx",sheet=2,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
rownames(envata)<-envata$Genus
envata<-envata[,-(1:7)]
dbpata<-dbpata[apply(dbpata, 1, function(x) !all(x==0)),]
#Genus 篩選
envata<-envata%>%
filter(apply(envata,1,function(x) sum(x>0)>=15))
envata$sum<-apply(envata,1,sum)
envata<-envata%>%
arrange(desc(sum))
envata<-envata[1:10,]
envata$sum<-NULL
#MGE篩選
MGE<-MGE%>%
filter(apply(MGE,1,function(x) sum(x>0)>=5))
MGE$sum<-apply(MGE,1,sum)
MGE<-MGE%>%
arrange(desc(sum))
MGE<-MGE[1:5,]
MGE$sum<-NULL
#data format transform
#envata<-scale(envata)
envata <- decostand(envata, method = 'hellinger')
dbpata<-as.data.frame(t(dbpata))
envata<-as.data.frame(t(envata))
MGE<-as.data.frame(t(MGE))
envata<-as.data.frame(cbind(envata,MGE))
envata<-scale(envata)
#檢查環境變量的相關性，共線的環境變量要去除
panel.cor <- function(x, y, digits=2, prefix="", cex.cor) {
usr <- par("usr")
on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y, use = "complete.obs"))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste(prefix, txt, sep = "")
if (missing(cex.cor)) cex <- 0.8 / strwidth(txt)
test <- cor.test(x, y)
# borrowed from printCoefmat
Signif <- symnum(
test$p.value, corr = FALSE, na = FALSE,
cutpoints = c(0, 0.05, 0.1, 1),
symbols = c("*", ".", " ")
)
text(0.5, 0.5, txt, cex = cex * r)
text(.8, .8, Signif, cex = cex, col = 2)
}
pairs(envata,lower.panel = panel.smooth,upper.panel = panel.cor)
#判斷要用RDA還是CCA,if DCA1 length >4 use cca
sel <- decorana(dbpata)
sel
#變量篩選
arg_cca<-rda(dbpata ~., data=envata)
envata<-as.data.frame(scale(envata))
#檢查環境變量的相關性，共線的環境變量要去除
panel.cor <- function(x, y, digits=2, prefix="", cex.cor) {
usr <- par("usr")
on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y, use = "complete.obs"))
txt <- format(c(r, 0.123456789), digits = digits)[1]
txt <- paste(prefix, txt, sep = "")
if (missing(cex.cor)) cex <- 0.8 / strwidth(txt)
test <- cor.test(x, y)
# borrowed from printCoefmat
Signif <- symnum(
test$p.value, corr = FALSE, na = FALSE,
cutpoints = c(0, 0.05, 0.1, 1),
symbols = c("*", ".", " ")
)
text(0.5, 0.5, txt, cex = cex * r)
text(.8, .8, Signif, cex = cex, col = 2)
}
pairs(envata,lower.panel = panel.smooth,upper.panel = panel.cor)
#判斷要用RDA還是CCA,if DCA1 length >4 use cca
sel <- decorana(dbpata)
sel
#變量篩選
arg_cca<-rda(dbpata ~., data=envata)
summary(arg_cca)
arg_cca_0<-rda(dbpata ~1, data=envata)
summary(arg_cca_0)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__Metabacillus+g__Nitrobacter, data=envata)
summary(arg_cca_1)
vif.cca(arg_cca_1)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__clostridium+g__Nitrobacter, data=envata)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__Clostridium+g__Nitrobacter, data=envata)
summary(arg_cca_1)
vif.cca(arg_cca_1)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__Metabacillus+g__Nitrobacter, data=envata)
summary(arg_cca_1)
mod.d
mod.u <- step(arg_cca_0, scope = formula(arg_cca_1), test = "perm")# "perm"增加P值等参数
mod.d <- step(arg_cca_0, scope = (list(lower = formula(arg_cca_0), upper = formula(arg_cca_1))))
mod.d
#檢驗變量的顯著度
set.seed(111)
anova(arg_cca_1,by = "term")
#檢驗軸的顯著度
anova(arg_cca_1,by = "axis",step=1000)
summary(arg_cca_0)
#變量篩選
arg_cca<-rda(dbpata ~., data=envata)
summary(arg_cca)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__Metabacillus+g__Nitrobacter+insertion_element_IS91__IS91, data=envata)
summary(arg_cca_1)
vif.cca(arg_cca_1)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__Metabacillus+insertion_element_IS91__IS91, data=envata)
summary(arg_cca_1)
vif.cca(arg_cca_1)
View(envata)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__Metabacillus+insertion_element_IS91__IS91+g__Nocardioides, data=envata)
summary(arg_cca_1)
vif.cca(arg_cca_1)
#變量篩選
arg_cca<-rda(dbpata ~., data=envata)
summary(arg_cca)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__Metabacillus+insertion_element_IS91__IS91+g__Nocardioides+transposase__tnpA , data=envata)
summary(arg_cca_1)
vif.cca(arg_cca_1)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__Metabacillus+insertion_element_IS91__IS91+transposase__tnpA , data=envata)
summary(arg_cca_1)
vif.cca(arg_cca_1)
#這步變量要一直不斷的篩選，直到組合起來所有變量的VIF都小於10
arg_cca_1<-rda(dbpata ~ g__Mycolicibacterium+g__Paracoccus +g__Metabacillus+insertion_element_IS91__IS91+transposase__tnpA , data=envata)
summary(arg_cca_1)
vif.cca(arg_cca_1)
mod.u <- step(arg_cca_0, scope = formula(arg_cca_1), test = "perm")# "perm"增加P值等参数
mod.d <- step(arg_cca_0, scope = (list(lower = formula(arg_cca_0), upper = formula(arg_cca_1))))
mod.d
#檢驗變量的顯著度
set.seed(111)
anova(arg_cca_1,by = "term")
#檢驗軸的顯著度
anova(arg_cca_1,by = "axis",step=1000)
rda.vpa <- varpart(dbpata, envata[,c(1:3)],envata[,c(11:13)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
## 繪圖數據提取
s.RDA=arg_cca_1$CCA$u#提取樣本之特徵值
B.rda.data=data.frame(arg_cca_1$CCA$u[,1:2],groupata$location)
View(envata)
View(envata)
rda.vpa <- varpart(dbpata, envata[,c(1,4,7,9)],envata[,c(11:12)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
rda.vpa <- varpart(dbpata, envata[,c(1,4,9)],envata[,c(11:12)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
rda.vpa <- varpart(dbpata, envata[,c(1,4,7)],envata[,c(11:12)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
rda.vpa <- varpart(dbpata, envata[,c(1:5)],envata[,c(11:12)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
rda.vpa <- varpart(dbpata, envata[,c(1:4)],envata[,c(11:12)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
## 繪圖數據提取
s.RDA=arg_cca_1$CCA$u#提取樣本之特徵值
rda.vpa <- varpart(dbpata, envata[,c(1:3)],envata[,c(11:12)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
rda.vpa <- varpart(dbpata, envata[,c(1:2)],envata[,c(11:12)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
plot(rda.vpa)
## 繪圖數據提取
s.RDA=arg_cca_1$CCA$u#提取樣本之特徵值
rda.vpa <- varpart(dbpata, envata[,c(1:10)],envata[,c(11:12)],chisquare = FALSE)
str(rda.vpa)
rda.vpa
B.plot
source("C:/Users/USER/Documents/GitHub/R_scripts/Plot/RDA_VPA.R", echo=TRUE)
