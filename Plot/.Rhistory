geom_bar(aes(x=sample,y=amount,fill=`ARGs type`,color=`ARGs type`),stat="identity",alpha=0.9)+
labs(x=NULL,y=NULL)+scale_fill_manual(values = color)+scale_color_manual(values = color)+theme(axis.title = element_text(size=13),axis.text = element_text(size=13),legend.title= element_text(size=12),legend.text = element_text(size=12))+theme_bw()+xlab("Sample")+ylab("ARGs abundance normalization against 16S")+theme_bw()
color<-c("#8DD3C7", "#FFFFB3" ,"#BC80BD" ,"#FB8072", "#80B1D3","#FDB462","#B3DE69","#FCCDE5","#D9D9D9","#CCEBC5","#BC80BD","#FFED6F")
ggplot(plotdata)+
geom_bar(aes(x=sample,y=amount,fill=`ARGs type`,color=`ARGs type`),stat="identity",alpha=0.9)+
labs(x=NULL,y=NULL)+scale_fill_manual(values = color)+scale_color_manual(values = color)+theme(axis.title = element_text(size=13),axis.text = element_text(size=13),legend.title= element_text(size=12),legend.text = element_text(size=12))+theme_bw()+xlab("Sample")+ylab("ARGs abundance normalization against 16S")+theme_bw()
color<-c("#8DD3C7", "#FFFFB3" ,"#BC80BD" ,"#FB8072", "#80B1D3","#FDB462","#B3DE69","#FCCDE5","#D9D9D9","#CCEBC5","#BEBADA","#FFED6F")
ggplot(plotdata)+
geom_bar(aes(x=sample,y=amount,fill=`ARGs type`,color=`ARGs type`),stat="identity",alpha=0.7)+
labs(x=NULL,y=NULL)+scale_fill_manual(values = color)+scale_color_manual(values = color)+theme(axis.title = element_text(size=13),axis.text = element_text(size=13),legend.title= element_text(size=12),legend.text = element_text(size=12))+theme_bw()+xlab("Sample")+ylab("ARGs abundance normalization against 16S")+theme_bw()
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/phyla_rel_table.xlsx_rel_table.xlsx",sheet=1)
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/phyla_rel_table.xlsx_rel_table.xlsx",sheet=1)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/phyla_rel_table.xlsx",sheet=1)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/phyla_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Phyla,into=c("n","Phyla"),sep = "__")
rownames(data_taxa)<-data_taxa$Phyla
data_taxa<-data_taxa[,-(1:8)]
data_taxa<-data_taxa*100
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:10,]
data_taxa$sum<-NULL
data_taxa$Genus<-rownames(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(30,60,90))
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#8DD3C7",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(30,60,90))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#8DD3C7",alpha=0.7)+theme_bw()+labs(y="Phyla")+scale_size(range=c(0,8),breaks=c(30,60,90))
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/family_rel_table.xlsx",sheet=1)
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/family_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Genus,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/family_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Family,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:8)]
data_taxa<-data_taxa*100
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:30,]
data_taxa$sum<-NULL
data_taxa$Genus<-rownames(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40))
View(data4)
View(data_taxa)
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/family_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Family,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:8)]
data_taxa<-data_taxa*100
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:30,]
data_taxa$sum<-NULL
data_taxa$Genus<-rownames(data_taxa)
View(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40))
View(data_taxa)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/family_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Family,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
View(data_taxa)
data_taxa<-data_taxa[,-(1:7)]
data_taxa<-data_taxa*100
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:30,]
data_taxa$sum<-NULL
data_taxa$Genus<-rownames(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(10,20,30,40,50,60))
brewer.pal(n=12,name="Set3")
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#FB8072",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(10,20,30,40,50,60))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(10,20,30,40,50,60))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,8),breaks=c(10,20,30,40,50,60))
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/phyla_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Phyla,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
View(data_taxa)
View(data_taxa)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Phyla,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:7)]
data_taxa<-data_taxa*100
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:10,]
data_taxa$sum<-NULL
data_taxa$Genus<-rownames(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,8),breaks=c(10,20,30,40,50,60))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,10),breaks=c(5,10,20,40,60,80))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,10),breaks=c(5,10,20,40,60,80,90))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,10),breaks=c(5,10,30,50,70,90))
brewer.pal(n=12,name="Set3")
"#80B1D3"
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#8DD3C7",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,10),breaks=c(5,10,30,50,70,90))
library("openxlsx")
library("ggplot2")
library("tidyverse")
library(RColorBrewer)
data<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/family_rel_table.xlsx",sheet=1)
data<-data[,-(1:4)]
data<-data[,-(2:3)]
data$Family<-gsub(pattern = "f__",replacement = "",x=data$Family)
rownames(data)<-data$Family
data$Family<-NULL
data[data<0.05]<-0
data_sum<-apply(data,2,sum)
dd<-1-data_sum
data2<-rbind(data,dd)
rownames(data2)[nrow(data2)]<-"Others"
data3<-data2[apply(data2, 1, function(x) !all(x==0)),]
data3$Family<-rownames(data3)
View(data3)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Genus,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:8)]
data_taxa<-data_taxa*100
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:50,]
data_sum<-apply(data,2,sum)
nrow(data_taxa)
data_taxa[nrow(data_taxa)+1,]<-data_sum
rownames(data_taxa)[nrow(data_taxa)+1]<-"Others"
rownames(data_taxa)[(nrow(data_taxa)+1)]<-"Others"
View(data_taxa)
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Genus,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:8)]
data_taxa<-data_taxa*100
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:50,]
data_sum<-apply(data,2,sum)
data_taxa[51,]<-data_sum
View(data_taxa)
data_taxa$sum<-NULL
data_sum<-apply(data,2,sum)
data_taxa[(nrow(data_taxa)+1),]<-data_sum
rownames(data_taxa)[(nrow(data_taxa)+1)]<-"Others"
rownames(data_taxa)
rownames(data_taxa)[51]<-"Others"
x<-nrow(data_taxa)+1
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Genus,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:8)]
data_taxa<-data_taxa*100
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:50,]
data_taxa$sum<-NULL
data_sum<-apply(data,2,sum)
x<-nrow(data_taxa)+1
data_taxa[x,]<-data_sum
rownames(data_taxa)[x]<-"Others"
data_taxa$Genus<-rownames(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40))
source("~/GitHub/R_scripts/Plot/TAXA heatmap_bubblechart.R", echo=TRUE)
View(data_taxa)
View(data4)
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Genus,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:8)]
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:50,]
data_taxa$sum<-NULL
data_sum<-apply(data,2,sum)
x<-nrow(data_taxa)+1
data_taxa[x,]<-(1-data_sum)
rownames(data_taxa)[x]<-"Others"
data_taxa$Genus<-rownames(data_taxa)
data_taxa<-data_taxa*100
View(data_taxa)
data_taxa<-data_taxa[,1:15]100
source("~/GitHub/R_scripts/Plot/TAXA heatmap_bubblechart.R", echo=TRUE)
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Genus,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:8)]
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:50,]
data_taxa$sum<-NULL
data_sum<-apply(data,2,sum)
x<-nrow(data_taxa)+1
data_taxa[x,]<-(1-data_sum)
rownames(data_taxa)[x]<-"Others"
data_taxa$Genus<-rownames(data_taxa)
data_taxa<-data_taxa[,1:15]*100
View(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40))
View(data_taxa)
library(openxlsx)
library(tidyverse)
library(pheatmap)
library(RColorBrewer)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/genus_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Genus,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:8)]
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:50,]
data_taxa$sum<-NULL
data_sum<-apply(data,2,sum)
x<-nrow(data_taxa)+1
data_taxa[x,]<-(1-data_sum)
rownames(data_taxa)[x]<-"Others"
data_taxa<-data_taxa[,1:15]*100
data_taxa$Genus<-rownames(data_taxa)
View(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40))
View(data4)
Genu<-data4$Genus
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
Genus<-data_taxa$Genus
Genus
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data_taxa$Genus<-factor(data_taxa$Genus)
data_taxa$Genus<-relevel(data_taxa$Genus,ref="Others")
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
Genu<-data4$Genus
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40))
ggplot(data4)+
geom_point(aes(x=Sample,Genus,size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40))
ggplot(data4)+
geom_point(aes(x=Sample,Genus,size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,40,50,60))
ggplot(data4)+
geom_point(aes(x=Sample,Genus,size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,6),breaks=c(5,10,20,25,30,40,50,60))
ggplot(data4)+
geom_point(aes(x=Sample,Genus,size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,7),breaks=c(5,10,20,25,30,40,50,60))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,35,40,50))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,7),breaks=c(5,10,20,25,30,35,40,50))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,7),breaks=c(5,10,20,25,30,40,50))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,6),breaks=c(5,10,20,25,30,40,50))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,40,50))
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/family_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Fenus,into=c("n","Genus"),sep = "__")
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Family,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:8)]
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:30,]
data_taxa$sum<-NULL
data_sum<-apply(data,2,sum)
x<-nrow(data_taxa)+1
data_taxa[x,]<-(1-data_sum)
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/family_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Family,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:7)]
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:30,]
data_taxa$sum<-NULL
data_sum<-apply(data,2,sum)
x<-nrow(data_taxa)+1
data_taxa[x,]<-(1-data_sum)
rownames(data_taxa)[x]<-"Others"
data_taxa<-data_taxa[,1:15]*100
data_taxa$Genus<-rownames(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data_taxa$Genus<-factor(data_taxa$Genus)
data_taxa$Genus<-relevel(data_taxa$Genus,ref="Others")
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
Genu<-data4$Genus
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#BEBADA",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,40,50))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#FB8072",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,40,50))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Genus")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,40,50))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,40,50))
data_taxa<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/rel abundance table/phyla_rel_table.xlsx",sheet=1)
#data_taxa<-data_taxa[,-(1:5)]
#data_taxa<-data_taxa[,-2]
data_taxa<-data_taxa%>%
separate(Phyla,into=c("n","Genus"),sep = "__")
rownames(data_taxa)<-data_taxa$Genus
data_taxa<-data_taxa[,-(1:7)]
?percent
#data_taxa<-data_taxa[apply(data_taxa, 1, function(x) !all(x==0)),]
#taxa top 20 abundance
data_taxa$sum<-apply(data_taxa,1,sum)
data_taxa<-arrange(data_taxa, desc(sum))
data_taxa<-data_taxa[1:10,]
data_taxa$sum<-NULL
data_sum<-apply(data,2,sum)
x<-nrow(data_taxa)+1
data_taxa[x,]<-(1-data_sum)
rownames(data_taxa)[x]<-"Others"
data_taxa<-data_taxa[,1:15]*100
data_taxa$Genus<-rownames(data_taxa)
#data_taxa<-data_taxa[,-(1:6)]
#data_taxa<-data_taxa[,-2]
data_taxa$Genus<-factor(data_taxa$Genus)
data_taxa$Genus<-relevel(data_taxa$Genus,ref="Others")
data4<-gather(data =data_taxa, key ="Sample",value = "Abundance",1:15)
#pheatmap(data_taxa,cluster_rows = F,cluster_cols =F)
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
Genu<-data4$Genus
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,8),breaks=c(5,10,20,25,30,40,50))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#80B1D3",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,8),breaks=c(10,30,50,70,90))
ggplot(data4)+
geom_point(aes(x=Sample,y=fct_rev(Genus),size=Abundance),color="#8DD3C7",alpha=0.7)+theme_bw()+labs(y="Family")+scale_size(range=c(0,8),breaks=c(10,30,50,70,90))
