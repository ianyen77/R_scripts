mutate(filename = str_remove(.x, ".xlsx"))%>%
mutate(filename = str_replace(filename, ".*/", ""))#%>%
#column_to_rownames(var = "filename")
})
x<-data.frame(ARG=df2$sum_ARG_coverage,MGE=df3$sum_MGE_coverage)
#contig number
x$ncontig<-c(90354,91885,113099,290322,307908,282737,57459,99158,60933,11284,11654,4449,18765,17889,13120)
#orf number
x$norf<-c(145709,150952,189623,443161,448192,432003,100355,144837,144837,31880,23860,9656,57648,51512,38876)
#Normaliztion coverage with contig number
x<-x%>%
mutate(A_ncontig=ARG/ncontig)%>%
mutate(M_ncontig=MGE/ncontig)
#sample selection
x1<-x[-(1:6),]
x2<-x[-(1:3),]
X$group<-rep(c("Raw","Finished","Upstream","Midstream","Downstream"),each=3)
library(openxlsx)
library(tidyverse)
library(ggpubr)
##ARG-like ORF coverage
file_path <- "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARC/indivisual assembly/ARC_sm70/ARC_ORF/ARG_orf_coverage/ARG_lik_orf_coverage/"
file_list <- list.files(path = file_path, pattern = ".xlsx", full.names = TRUE)
df2 <- map_dfr(file_list, ~{
read.xlsx(.x) %>%
select(orf_coverage) %>%
summarise(sum_ARG_coverage = sum(orf_coverage)) %>%
mutate(filename = str_remove(.x, ".xlsx"))%>%
mutate(filename = str_replace(filename, ".*/", ""))#%>%
#column_to_rownames(var = "filename")
})
##因為有兩個sample 沒有比對到ARG，所以我們手動幫她加入
new_row <- data.frame(sum_ARG_coverage=c(0,0) ,filename =c("T4-W-2ARG_like_orf_cov_all","T4-W-3ARG_like_orf_cov_all"))
df2<- rbind(slice(df2, 1:10), new_row, slice(df2, 11:13))
##MGE-like ORF coverage
file_path <- "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARC/indivisual assembly/MGE_coverage/MGE_lik_orf_coverage/"
file_list <- list.files(path = file_path, pattern = ".xlsx", full.names = TRUE)
df3 <- map_dfr(file_list, ~{
read.xlsx(.x) %>%
select(orf_coverage) %>%
summarise(sum_MGE_coverage = sum(orf_coverage)) %>%
mutate(filename = str_remove(.x, ".xlsx"))%>%
mutate(filename = str_replace(filename, ".*/", ""))#%>%
#column_to_rownames(var = "filename")
})
x<-data.frame(ARG=df2$sum_ARG_coverage,MGE=df3$sum_MGE_coverage)
#contig number
x$ncontig<-c(90354,91885,113099,290322,307908,282737,57459,99158,60933,11284,11654,4449,18765,17889,13120)
#orf number
x$norf<-c(145709,150952,189623,443161,448192,432003,100355,144837,144837,31880,23860,9656,57648,51512,38876)
#Normaliztion coverage with contig number
x<-x%>%
mutate(A_ncontig=ARG/ncontig)%>%
mutate(M_ncontig=MGE/ncontig)
x$group<-rep(c("Raw","Finished","Upstream","Midstream","Downstream"),each=3)
source("~/GitHub/R_scripts/Plot/ARG_orf_MGE_orfcoverage.R.R", echo=TRUE)
ggplot(data = x,aes(x=M_ncontig,y=A_ncontig,color=group,fill=group))+
geom_point(size=3,alpha=0.7)+geom_smooth(method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
x$group<-rep(c("Raw","Raw","Raw","Finished","Finished","Finished","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS"))
#sample selection
x1<-x[-(1:6),]
x2<-x[-(1:3),]
ggplot(data = x,aes(x=M_ncontig,y=A_ncontig,color=group,fill=group))+
geom_point(size=3,alpha=0.7)+geom_smooth(method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data = x,aes(x=MGE,y=ARG,color=group,fill=group))+
geom_point(size=3,alpha=0.7)+geom_smooth(method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
x$group2<-rep(c("Raw","Raw","Raw","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW"))
ggplot(data = x,aes(x=MGE,y=ARG,color=group2,fill=group2))+
geom_point(size=3,alpha=0.7)+geom_smooth(method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data = x,aes(x=MGE,y=ARG,color=group1,fill=group1))+
geom_point(size=3,alpha=0.7)+geom_smooth(method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data = x,aes(x=MGE,y=ARG,color=group,fill=group))+
geom_point(size=3,alpha=0.7)+geom_smooth(method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data = x,aes(x=MGE,y=ARG))+
geom_point(size=3,alpha=0.7)+geom_smooth(method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data = x,aes(x=MGE,y=ARG))+
geom_point(color=  "#80B1D3",size=3,alpha=0.7)+geom_smooth(color=  "#80B1D3",method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
##ggscatter---------------------
ggscatter(data=x2,x="M_ncontig",y="A_ncontig",color=group,fill=group,add = "reg.line", conf.int = TRUE,  color=  "#80B1D3",alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
##ggscatter---------------------
ggscatter(data=x2,x="M_ncontig",y="A_ncontig",color=group,fill=group,add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
##ggscatter---------------------
ggscatter(data=x,x="M_ncontig",y="A_ncontig",color=group,fill=group,add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
##ggscatter---------------------
ggscatter(data=x,x="M_ncontig",y="A_ncontig",color="group",fill="group",add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
##ggscatter---------------------
ggscatter(data=x,x="M_ncontig",y="A_ncontig",color="group",fill="group",add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson", label.x =0.15, label.y = 0.001,group=group)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
##ggscatter---------------------
ggscatter(data=x,x="M_ncontig",y="A_ncontig",color="group",fill="group",add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson", label.x =0.15, label.y = 0.001,group="group")+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
stat_cor(method = "pearson", label.x =0.15, label.y = 0.001,group="group")
##ggscatter---------------------
ggscatter(data=x,x="M_ncontig",y="A_ncontig",color="group",fill="group",add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group),method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
##ggscatter---------------------
ggscatter(data=x,x="M_ncontig",y="A_ncontig",color="group",fill="group",add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
library(openxlsx)
library(tidyverse)
library(ggpubr)
##ARG-like ORF coverage
file_path <- "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARC/indivisual assembly/ARC_sm70/ARC_ORF/ARG_orf_coverage/ARG_lik_orf_coverage/"
file_list <- list.files(path = file_path, pattern = ".xlsx", full.names = TRUE)
df2 <- map_dfr(file_list, ~{
read.xlsx(.x) %>%
select(orf_coverage) %>%
summarise(sum_ARG_coverage = sum(orf_coverage)) %>%
mutate(filename = str_remove(.x, ".xlsx"))%>%
mutate(filename = str_replace(filename, ".*/", ""))#%>%
#column_to_rownames(var = "filename")
})
##因為有兩個sample 沒有比對到ARG，所以我們手動幫她加入
new_row <- data.frame(sum_ARG_coverage=c(0,0) ,filename =c("T4-W-2ARG_like_orf_cov_all","T4-W-3ARG_like_orf_cov_all"))
df2<- rbind(slice(df2, 1:10), new_row, slice(df2, 11:13))
##MGE-like ORF coverage
file_path <- "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARC/indivisual assembly/MGE_coverage/MGE_lik_orf_coverage/"
file_list <- list.files(path = file_path, pattern = ".xlsx", full.names = TRUE)
df3 <- map_dfr(file_list, ~{
read.xlsx(.x) %>%
select(orf_coverage) %>%
summarise(sum_MGE_coverage = sum(orf_coverage)) %>%
mutate(filename = str_remove(.x, ".xlsx"))%>%
mutate(filename = str_replace(filename, ".*/", ""))#%>%
#column_to_rownames(var = "filename")
})
x<-data.frame(ARG=df2$sum_ARG_coverage,MGE=df3$sum_MGE_coverage)
#contig number
x$ncontig<-c(90354,91885,113099,290322,307908,282737,57459,99158,60933,11284,11654,4449,18765,17889,13120)
#orf number
x$norf<-c(145709,150952,189623,443161,448192,432003,100355,144837,144837,31880,23860,9656,57648,51512,38876)
#Normaliztion coverage with contig number
x<-x%>%
mutate(A_ncontig=ARG/ncontig)%>%
mutate(M_ncontig=MGE/ncontig)
x$group<-rep(c("Raw","Finished","Upstream","Midstream","Downstream"),each=3)
#sample selection
x1<-x[-(1:6),]
x2<-x[-(1:3),]
ggplot(data = x,aes(x=M_ncontig,y=A_ncontig,color=group))+
geom_point(size=3,alpha=0.7)+geom_smooth(method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
cor.test(x2$A_ncontig,x2$M_ncontig)
##ggscatter---------------------
ggscatter(data=x2,x="M_ncontig",y="A_ncontig", add = "reg.line", conf.int = TRUE,  color=  "#80B1D3",alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
ggplot(data = x,aes(x=M_ncontig,y=A_ncontig))+
geom_point(size=3,alpha=0.7,color=  "#80B1D3")+geom_smooth(color=  "#80B1D3",method =lm,alpha=0.3) +theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))
color<-hcl.colors(5,sunset)
color<-hcl.colors(5,"sunset")
color
color1<-c("#F9B282","#ED7C97","#704D9E" )
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="group",color="group", add = "reg.line", conf.int = TRUE,  color=  "#80B1D3",alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group),method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="group",color="group", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group),method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="group1",color="group1", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group),method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="group1",color="group1", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group1),method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="group2",color="group2", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group2),method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
x$group2<-rep(c("Raw","Raw","Raw","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW"))
color<-hcl.colors(5,"sunset")
color1<-c("#F9B282","#ED7C97","#704D9E" )
"#704D9E" "#BC5AA9" "#ED7C97" "#F9B282" "#F3E79A"
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="group2",color="group2", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group2),method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
color2<-c("#F9B282","#704D9E")
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="group2",color="group2", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group2),method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
color2<-c("#704D9E","#F9B282")
"#704D9E" "#BC5AA9" "#ED7C97" "#F9B282" "#F3E79A"
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="group2",color="group2", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group2),method = "pearson", label.x =0.15, label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="group2",color="group2", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group2),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
##Multigroup-----with normalized
ggscatter(data=x,x="MGE",y="ARG",fill="group2",color="group2", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group2),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
x$Location<-rep(c("Raw","Raw","Raw","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW"))
x$Type<-rep(c("Raw","Raw","Raw","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW","DW"))
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="group2",color="group2", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group2),method = "pearson", label.y = 0.001)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="group2",color="group2", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group2),method = "pearson", label.x = 200)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="group2",color="group2", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=group2),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",,color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
##Multigroup-----with normalized
x$Type<-c("Raw","Raw","Raw","Finished","Finished","Finished","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS")
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color2)
color1<-c("#F9B282","#ED7C97","#704D9E" )
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contig number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
color1<-rev(c("#F9B282","#ED7C97","#704D9E" ))
color2<-c("#704D9E","#F9B282")
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
x$Type<-factor(x$Type,levles=c("Raw","Finished","DW"))
x$Type<-factor(x$Type,levle=c("Raw","Finished","DW"))
x$Type<-factor(x$Type,levels =c("Raw","Finished","DW"))
color<-hcl.colors(5,"sunset")
color1<-rev(c("#F9B282","#ED7C97","#704D9E" ))
color2<-c("#704D9E","#F9B282")
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
x$Type<-factor(x$Type,levels =c("Raw","Finished","DWDS"))
color<-hcl.colors(5,"sunset")
color1<-rev(c("#F9B282","#ED7C97","#704D9E" ))
color2<-c("#704D9E","#F9B282")
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----with normalized
x$Type<-c("Raw","Raw","Raw","Finished","Finished","Finished","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS","DWDS")
x$Type<-factor(x$Type,levels =c("Raw","Finished","DWDS"))
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
color1<-rev(c("#F9B282","#ED7C97","#704D9E" ))
color2<-c("#704D9E","#F9B282")
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
color1<-(c("#F9B282","#ED7C97","#704D9E" )
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
color1<-c("#F9B282","#ED7C97","#704D9E" )
color2<-c("#704D9E","#F9B282")
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",fill="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+  geom_smooth(method = "lm", color = "black") +
stat_cor(label.x = 3)+stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3))+  geom_smooth(method = "lm", color = "black") +
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black") +
stat_cor(label.x = 3)+stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black") +
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "grey") +
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "#704D9E") +
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
color<-hcl.colors(4,"sunset")
color
color<-hcl.colors(6,"sunset")
color
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "#AF56A9") +
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.3) +
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.8) +
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=1 +
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=1)+
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=2)+
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=2)+
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=1)+
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=1,alpha=0.7)+
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=1,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "grey",size=1,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "grey",size=1,alpha=0.3)+
stat_cor(method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "grey",size=1,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.8,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.6,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.6,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.6,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.6,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----with normalized
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup---with normalized
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", conf.int = TRUE, alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup---with normalized
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type",add = "reg.line", conf.int = TRUE, alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup---with normalized
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", conf.int = TRUE, alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+geom_smooth(method = "lm", color = "black",size=0.6,alpha=0.3)+stat_cor(method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----with normalized, without group regression
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----with normalized, without group regression
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.6,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup---with normalized,without group regression
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", conf.int = TRUE, alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+geom_smooth(method = "lm", color = "black",size=0.6,alpha=0.3)+stat_cor(method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----with normalized
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.6,alpha=0.3)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "black",size=0.6,alpha=0.2)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "darkgrey",size=0.6,alpha=0.2)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.6,size=3)+  geom_smooth(method = "lm", color = "darkgrey",size=0.7,alpha=0.2)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.7,size=3)+  geom_smooth(method = "lm", color = "darkgrey",size=0.7,alpha=0.2)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.7,size=3)+  geom_smooth(method = "lm", color = "grey",size=0.7,alpha=0.2)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup---with normalized,without group regression
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", conf.int = TRUE, alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+geom_smooth(method = "lm", color = "darkgrey",size=0.6,alpha=0.3)+stat_cor(method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup---with normalized,without group regression
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", conf.int = TRUE, alpha=0.6,size=3,
add.params = list(fill = "lightgray"))+geom_smooth(method = "lm", color = "grey",size=0.6,alpha=0.3)+stat_cor(method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.7,size=3)+  geom_smooth(method = "lm", color = "grey",alpha=0.2)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup---with normalized,without group regression
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", conf.int = TRUE, alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+geom_smooth(method = "lm", color = "grey",alpha=0.2)+stat_cor(method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----with normalized
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup--- without normalized,without group regression
ggscatter(data=x,x="MGE",y="ARG",color="Type", conf.int = TRUE,alpha=0.7,size=3)+  geom_smooth(method = "lm", color = "grey",alpha=0.2)+
stat_cor(method = "pearson", label.x = 300,label.y=20)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----without normalized
ggscatter(data=x,x="MGE",y="ARG",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson", label.x = 300)+theme_bw()+labs(x="Total MGE-like ORF coverage (x/GB)",y="Total ARG-like ORF(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup---with normalized,without group regression
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", conf.int = TRUE, alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+geom_smooth(method = "lm", color = "grey",alpha=0.2)+stat_cor(method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
##Multigroup-----with normalized
ggscatter(data=x,x="M_ncontig",y="A_ncontig",fill="Type",color="Type", add = "reg.line", conf.int = TRUE,alpha=0.7,size=3,
add.params = list(fill = "lightgray"))+stat_cor(aes(color=Type),method = "pearson")+theme_bw()+labs(x="Total MGE-like ORF coverage against contigs number(x/GB)",y="Total ARG-like ORF coverage against contig number(x/GB)")+
theme(axis.title = element_text(size=13),axis.text =element_text(size=12.5)  ,legend.title= element_text(size=12),legend.text = element_text(size=12))+scale_color_manual(values=color1)
