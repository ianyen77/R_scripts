theme_bw()+
geom_point(size=3)+#geom_text(aes(label=sample_ID),size=3,color="black",)+
scale_color_manual(values = color)+geom_hline(yintercept=0)+ geom_vline(xintercept=0)+theme(panel.grid=element_blank())+
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
dbpata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
groupata<-read.xlsx("C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/TAXA/groupdata.xlsx",sheet=1,rowNames=T,colNames=T,sep.names=" ")
#以上不一定需要，看你分析的DATA
dbpata <-as.data.frame(t(dbpata))
family_bray<-vegdist(dbpata, method="bray")
length_1<-length(rownames(dbpata))
pcoa = cmdscale(family_bray, k=(length_1-1), eig=TRUE)
points=scores(pcoa)
eig = pcoa$eig
eig
points<-as.data.frame(points)
points <-cbind(points, groupata[match(rownames(points), rownames(groupata)), ])
#用Adonis 來檢定組間差異是不是顯著的
x<-adonis2(dbpata~location,data = groupata)
x
dbpata_adonis <- paste0("adonis R2: ",round(x$R2,2), "; P-value: ", x$`Pr(>F)`)
#檢驗adnois，我們需要檢驗一下這個adonis的結果是不是因為分組數據的離散程度不同造成的
dbpata.dis <- vegdist(dbpata, method="bray", binary=F)
dispersion <- betadisper(dbpata.dis, group=groupata$location)
permutest(dispersion,permutations = 99999)
points$location<-factor(points$location,levels=c('Raw', 'Finished', 'Upstream','Midstream','Downstream'))
RColorBrewer::display.brewer.all()
display.brewer.pal(n=12,name="Set3")
brewer.pal(n=12,name="Set3")
color<-c("#FB8072","#BEBADA","#80B1D3","#FDB462","#B3DE69")
#2dpcoa
ggplot(points, aes(x=Dim1, y=Dim2,colour=location))+
theme_bw()+
geom_point(size=3)+#geom_text(aes(label=sample_ID),size=3,color="black",)+
scale_color_manual(values = color)+geom_hline(yintercept=0)+ geom_vline(xintercept=0)+theme(panel.grid=element_blank())+
labs(x=paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep=""),
y=paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep=""),
title="Bray_curtis PCoA")+theme(axis.title = element_text(size=12),legend.title= element_text(size=12),legend.text = element_text(size=12))
#3dpoca
colors=color[as.numeric(points$location)]
colnames(points)[1]<-paste("PCoA 1 (", format(100 * eig[1] / sum(eig), digits=4), "%)", sep="")
colnames(points)[2]<-paste("PCoA 2 (", format(100 * eig[2] / sum(eig), digits=4), "%)", sep="")
colnames(points)[3]<-paste("PCoA 3 (", format(100 * eig[3] / sum(eig), digits=4), "%)", sep="")
scatterplot3d(points[,1:3],color=colors,main="Bray_curtis PCoA",pch=16,cex.symbols = 1.3)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = T)
View(data)
data$sum<-apply(data,1,sum)
data<-data%>%
arrange(desc(sum))
data<-data[1:30,]
data[data == 0] <- NA
data$sum<-NULL
data_log<-log10(data)
View(data_log)
pheatmap(data_log,cluster_rows = F,cluster_cols = F)
library(pheatmap)
pheatmap(data_log,cluster_rows = F,cluster_cols = F)
pheatmap(data_log,cluster_rows = F,cluster_cols = F, legend_labels = c("-4", "-3", "-2", "-1", "log ARGs abundance\n(copy/16S rRNA gene)"),
legend = TRUE, cluster_rows = FALSE, cluster_cols = FALSE)
pheatmap(data_log,cluster_rows = F,cluster_cols = F, legend_labels = c("-4", "-3", "-2", "-1", "log ARGs abundance\n(copy/16S rRNA gene)"),
legend = T)
pheatmap(data_log,cluster_rows = F,cluster_cols = F, legend_labels = c("-4", "-3", "-2", "-1", "log ARGs abundance\n(copy/16S rRNA gene)"),
legend = T)
pheatmap(data_log,cluster_rows = F,cluster_cols = F,legend = TRUE,legend_labels = c("-4", "-3", "-2", "-1", "log ARGs abundance\n(copy/16S rRNA gene)"))
pheatmap(data_log,cluster_rows = F,cluster_cols = F,legend = TRUE,legend_labels = c("-4", "-3", "-2", "-1", "log ARGs abundance"))
pheatmap(data_log,cluster_rows = F,cluster_cols = F,legend = TRUE,legend_breaks = -1:4,legend_labels = c("-4", "-3", "-2", "-1", "log ARGs abundance"))
pheatmap(data_log,cluster_rows = F,cluster_cols = F,legend = TRUE,legend_breaks = -1:-4,legend_labels = c("-4", "-3", "-2", "-1", "log ARGs abundance"))
pheatmap(data_log,cluster_rows = F,cluster_cols = F,legend = TRUE,legend_labels ="log ARGs abundance")
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_colors ="log")
?pheatmap
pheatmap(data_log,cluster_rows = F,cluster_cols = F, legend_labels="log")
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = T)
data$sum<-apply(data,1,sum)
data<-data%>%
arrange(desc(sum))
data<-data[1:30,]
data[data == 0] <- NA
data$sum<-NULL
View(data_log)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
View(data)
data_argname<-separate(data$ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
View(data)
data_argname<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
View(data_argname)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
colnames(data)<-data$subtype
rownames(data)<-data$subtype
data$type<-NULL
data$subtype<-NULL
data$sum<-apply(data,1,sum)
data<-data%>%
arrange(desc(sum))
data<-data[1:30,]
data[data == 0] <- NA
data$sum<-NULL
data_log<-log10(data)
#data_log<-data_log[-(1:3),]
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_colors ="log")
?pheatmap
#data_log<-data_log[-(1:3),]
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_colors ="log")
View(data_argname)
#data_log<-data_log[-(1:3),]
#添加group資訊
rownames(data_argname)<-data_argname$subtype
data_argname<-data_argname[,1]
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$type<-NULL
data$subtype<-NULL
data$sum<-apply(data,1,sum)
data<-data%>%
arrange(desc(sum))
data<-data[1:30,]
data[data == 0] <- NA
data$sum<-NULL
data_log<-log10(data)
#data_log<-data_log[-(1:3),]
#添加group資訊
rownames(data_argname)<-data_argname$subtype
View(data_argname)
data_argname<-as.dataframe(data_argname[,1])
data_argname<-as.data.frame(data_argname[,1])
annotation_row<-data_argname
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_colors ="log",annotation_row = annotation_row)
annotation_col = data.frame(
group = rep(c("Group_A", "Group_B"), each = 5),
row.names = colnames(exp))
head(annotation_col)
exp = matrix(rnorm(300), nrow = 30, ncol = 10)
exp[1:15, 1:5] = exp[1:15, 1:5] + matrix(rnorm(75,mean = 4), nrow = 15, ncol = 5)
exp[16:30, 6:10] = exp[16:30, 6:10] + matrix(rnorm(75,mean = 3), nrow = 15, ncol = 5)
exp = round(exp, 2)
colnames(exp) = paste("Sample", 1:10, sep = "")
rownames(exp) = paste("Gene", 1:30, sep = "")
head(exp)
annotation_col = data.frame(
group = rep(c("Group_A", "Group_B"), each = 5),
row.names = colnames(exp))
head(annotation_col)
View(annotation_col)
View(annotation_row)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$type<-NULL
data$subtype<-NULL
data$sum<-apply(data,1,sum)
data<-data%>%
arrange(desc(sum))
data<-data[1:30,]
data[data == 0] <- NA
data$sum<-NULL
data_log<-log10(data)
#data_log<-data_log[-(1:3),]
#添加group資訊
rownames(data_argname)<-data_argname$subtype
View(data_argname)
data_argname<-as.data.frame(data_argname[,1:2])
View(annotation_row)
View(data_argname)
annotation_row<-data_argname[,-2]
data_argname<-data.frame(data_argname[,1])
View(data_argname)
ata<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$type<-NULL
data$subtype<-NULL
data$sum<-apply(data,1,sum)
data<-data%>%
arrange(desc(sum))
data<-data[1:30,]
data[data == 0] <- NA
data$sum<-NULL
data_log<-log10(data)
View(ata)
View(data_argname)
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
View(data_argname)
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_colors ="log",annotation_row =data_argname)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$type<-NULL
data$subtype<-NULL
data$sum<-apply(data,1,sum)
data<-data%>%
arrange(desc(sum))
data<-data[1:30,]
data[data == 0] <- NA
data$sum<-NULL
data_log<-log10(data)
View(data_argname)
View(data_log)
View(data)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
View(data)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
View(data)
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data<-data[1:30,]
data[data == 0] <- NA
data$sum<-NULL
View(data)
View(data_argname)
View(data)
data_argname<-data[,1:2]
View(data_argname)
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
View(data_argname)
rownames(data_argname)<-name
data<-data[,-(1:2)]
data_log<-log10(data)
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_colors ="log",)
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_row = data_argname)
View(data_argname)
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
View(data_argname)
colnames(data_argname)<-"ARGs Type"
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_row = data_argname)
pheatmap(data_log,cluster_cols = F,annotation_row = data_argname)
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_row = data_argname)
pheatmap(data_log,cluster_cols = F,annotation_row = data_argname)
View(data_log)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$type<-NULL
data$subtype<-NULL
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
#畫圖
data<-data[,-(1:2)]
pheatmap(data_log,cluster_cols = F,annotation_row = data_argname)
pheatmap(data,cluster_cols = F,annotation_row = data_argname)
View(data)
pheatmap(data,cluster_cols = F,annotation_row = data_argname)
pheatmap(data,annotation_row = data_argname)
View(data_argname)
View(data)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$type<-NULL
data$subtype<-NULL
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
View(data_argname)
View(data)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data<-data[1:30,]
data[data == 0] <- NA
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
#畫圖
data<-data[,-(1:2)]
pheatmap(data,annotation_row = data_argname)
library(pheatmap)
library(openxlsx)
library(tidyverse)
library(pheatmap)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data$sum<-NULL
data<-data[1:30,]
data[data == 0] <- NA
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
#畫圖
data<-data[,-(1:2)]
pheatmap(data,annotation_row = data_argname)
data_log<-log10(data)
pheatmap(data,annotation_row = data_argname)
pheatmap(data_log,data,annotation_row = data_argname)
View(data)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data$sum<-NULL
data<-data[1:30,]
data[data == 0] <- NA
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
#畫圖
data<-data[,-(1:2)]
data_log<-log10(data)
pheatmap(data_log,data,annotation_row = data_argname)
pheatmap(data_log,annotation_row = data_argname)
library(pheatmap)
library(openxlsx)
library(tidyverse)
library(pheatmap)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data$sum<-NULL
data<-data[1:30,]
data[data == 0] <- NA
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
#畫圖
data<-data[,-(1:2)]
data_log<-log10(data)
pheatmap(data_log,annotation_row = data_argname)
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_row = data_argname)
pheatmap(data_log,cluster_cols = F,annotation_row = data_argname)
View(data_argname)
pheatmap(data_log,cluster_cols = F,annotation_row = data_argname,display_numbers =T)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data$sum<-NULL
data<-data[1:30,]
data[data == 0] <- NA
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
#畫圖
data<-data[,-(1:2)]
pheatmap(data,cluscluster_cols = F,annotation_row = data_argname,display_numbers =T)
View(data)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data$sum<-NULL
data<-data[1:30,]
#data[data == 0] <- NA
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
#畫圖
data<-data[,-(1:2)]
pheatmap(data,cluscluster_cols = F,annotation_row = data_argname,display_numbers =T)
pheatmap(data,annotation_row = data_argname,)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data$sum<-NULL
data<-data[1:30,]
data[data == 0] <- NA
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
#畫圖
data<-data[,-(1:2)]
data_log<-log10(data)
pheatmap(data,annotation_row = data_argname,)
pheatmap(data,annotation_row = data_argname)
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data$sum<-NULL
data<-data[1:30,]
data[data == 0] <- NA
data_argname<-data[,1:2]
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
data<-read.xlsx(xlsxFile = "C:/Users/USER/Desktop/lab/實驗/Metagenomic in DWDS/DATA/newDATA/ARG/ARGoap_out.xlsx",sheet=1,rowNames = F)
data<-separate(data,ARGs.abundance.normalization.aganist.16S,into = c("type","subtype"),sep="__")
data_argname<-data
rownames(data)<-data$subtype
data$sum<-apply(data[,3:17],1,sum)
data<-data%>%
arrange(desc(sum))
data$sum<-NULL
data<-data[1:30,]
data<-data%>%
arrange(data$type)
data[data == 0] <- NA
data_argname<-data[,1:2]
View(data_argname)
#data_log<-data_log[-(1:3),]
#添加group資訊
name<-data_argname$subtype
data_argname<-data.frame(data_argname[,1])
rownames(data_argname)<-name
data_argname[data_argname=="macrolide-lincosamide-streptogramin"]<-"MLS"
colnames(data_argname)<-"ARGs Type"
#畫圖
data<-data[,-(1:2)]
data_log<-log10(data)
pheatmap(data,annotation_row = data_argname)
pheatmap(data,cluster_rows = F,cluster_cols = Fannotation_row = data_argname)
pheatmap(data,cluster_rows = F,cluster_cols = F,annotation_row = data_argname)
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_row = data_argname)
location<-c("Raw","Raw","Raw","Finished","Finished","Finished","Upstream","Upstream","Upstream","Midstream","Midstream","Midstream","Downstream","Downstream","Downstream")
row_ano<-cbind(colnames(data),location)
View(row_ano)
View(row_ano)
rownames(row_ano)<-row_ano$V1
row_ano<-data.frame(cbind(colnames(data),location))
rownames(row_ano)<-row_ano$V1
row_ano$V1<-NULL
pheatmap(data_log,cluster_rows = F,cluster_cols = F,annotation_row = data_argname,annotation_col = row_ano)
